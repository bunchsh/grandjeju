<!-- @filename    : reservation.html
@author      : 한송희 (onee.ssong@gmail.com)
@description : Grandjeju 예약하기 페이지의 구조 -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GrandJeju - RESERVATION</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css" />
    <link rel="stylesheet" href="../assets/css/all.css">
    <link rel="stylesheet" href="../assets/css/header_style.css">
    <link rel="stylesheet" href="assets/css/style_reservation.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&family=Rubik&display=swap" rel="stylesheet">
</head>

<body>
    <div id="wrap">
        <!-- HEADER -->
        <div id="header">
            <h2 class="title">RESERVATION</h2>
        </div>

        <!-- CONTAINER -->
        <div id="container">
            <!-- CONTENT -->
            <div id="content">
                <form action="" id="reservation">
                    <!-- 객실 선택 -->
                    <div class="room_group">
                        <h3 class="room_title">객실 선택</h3>
                        <select id="room_select" onchange="roomPerson(this)">
                            <option value="">객실 선택</option>
                            <option value="35M" data-price="40000">35M</option>
                            <option value="35O" data-price="40000">35O</option>
                            <option value="50M" data-price="70000">50M</option>
                            <option value="70O" data-price="120000">70O</option>
                            <option value="85M" data-price="160000">85M</option>
                        </select>
                        <span class="errmsg_room" style="display: none">객실을 선택해 주세요.</span>
                    </div>
                    <!-- 인원 선택 -->
                    <div class="person_group">
                        <h3 class="person_title">인원 선택</h3>
                        <select id="person_select">
                            <option value="">인원 선택</option>
                        </select>
                    </div>
                    <!-- 숙박 기간 -->
                    <div class="day_group">
                        <h3 class="day_title">숙박 기간</h3>
                        <input class="day_select" placeholder="2022-01-26 ~ 2022-01-27">
                    </div>
                    <span class="errmsg_day" style="display: none">숙박 기간을 선택해 주세요.</span>
                    <!-- 예약자명 -->
                    <div class="booker_group">
                        <h3 class="booker_title">예약자명</h3>
                        <input type="text" class="booker_input">
                        <span class="errmsg_booker" style="display: none">예약자명을 입력해 주세요.</span>
                        <span class="errmsg_min" style="display: none">예약자명은 2자 이상 입력 가능합니다.</span>
                        <span class="errmsg_kor" style="display: none">예약자명은 한글만 입력 가능합니다.</span>
                    </div>
                    <!-- 예약자 연락처 -->
                    <div class="phone_group">
                        <h3 class="phone_title">예약자 연락처</h3>
                        <input type="tel" class="phone_input">
                        <span class="errmsg_phone" style="display: none">올바른 예약자 연락처를 입력해 주세요.</span>
                    </div>
                    <!-- 결제 수단 -->
                    <div class="paybtn_group">
                        <h3 class="paybtn_title">결제 수단</h3>
                        <div>
                            <div class="radio-items">
                                <div class="credit">
                                    <input id="credit" class="only-sr" type="radio" name="pay" value="creditcard">
                                    <label for="credit">신용카드</label>
                                </div>
                                <div class="payco">
                                    <input id="payco" class="only-sr" type="radio" name="pay" value="payco">
                                    <label for="payco"><img src="./assets/img/payco.png" alt="페이코"></label>
                                </div>
                                <div class="kakaopay">
                                    <input id="kakaopay" class="only-sr" type="radio" name="pay" value="kakaopay">
                                    <label for="kakaopay"><img src="./assets/img/제목 없음-1.png" alt="카카오페이"></label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <span class="errmsg_paytype" style="display: none">결제수단을 선택해 주세요.</span>
                    <!-- 결제 금액 -->
                    <div class="payfee_group">
                        <h3 class="payfee_title">결제 금액</h3>
                        <span class="payfee"></span>
                        <span class="payfee_won"> 원</span>
                    </div>
                    <!-- 결제하기 버튼 -->
                    <div class="pay_group">
                        <button class="pay" type="submit">결제하기</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 유효성 검사를 사용하기 위한 script -->
    <script src="./assets/js/reservation_regex_helper.js"></script>

    <!-- flatpickr을 사용하기 위한 script -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="./assets/js/flatpickr_reservation.js"></script>

    <!-- 객실에 따른 선택 가능 인원 출력 -->
    <script src="./assets/js/person_option.js"></script>

    <!-- 아임 포트 사용 -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script type="text/javascript" src="https://service.iamport.kr/js/iamport.payment-1.1.5.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!-- 예약 버튼 이벤트 -->
    <script src="./assets/js/pay_price.js"></script>

    <script>
    //     (async () => {
    //     let json = null;

    //     try {
    //         const response = await axios.get('/members/info');
    //         json = response.data;
    //     } catch (e) {
    //         alert(e.response.data.rtmsg);
    //         window.location = "/GJ2_login_page/login.html";
    //         return;
    //     }

    //     console.log(json.item);

    //     /** 예약 정보 DB 저장 */
    //     if (json != null) {
    //         document.querySelector("#reservation").addEventListener("submit", async (e) => {
    //             e.preventDefault();

    //             // 입력값 받아오기
    //             const room = document.querySelector("#room_select").value;
    //             console.log(room);
    //             const person = document.querySelector("#person_select").value;
    //             console.log(person);

    //             const stay_start = document.querySelector(".day_select").value.slice(0, 10);
    //             const cut = document.querySelector(".day_select").value.indexOf("~") + 2;
    //             const stay_end = document.querySelector(".day_select").value.slice(cut, cut + 10);
    //             console.log(stay_start);
    //             console.log(stay_end);

    //             const reserv_name = document.querySelector(".booker_input").value;
    //             console.log(reserv_name);
    //             const reserv_phone = document.querySelector(".phone_input").value;
    //             console.log(reserv_phone);

    //             const pay_way = document.querySelector(".only-sr").value;
    //             console.log(pay_way);
    //             // const pay_price = total_price;
    //             console.log(total_price);

    //             const order_no = 'test123';
    //             console.log(order_no);

    //             // 입력값에 대한 유효성 검사 진행 (생략)

    //             let json2 = null;

    //             try {
    //                 const response = await axios.post("/reservation", {
    //                     user_id: json.item.user_id,
    //                     room: room,
    //                     person: person,
    //                     stay_start: stay_start,
    //                     stay_end: stay_end,
    //                     reserv_name: reserv_name,
    //                     reserv_phone: reserv_phone,
    //                     pay_way: pay_way,
    //                     pay_price: total_price,
    //                     order_no: order_no
    //                 });

    //                 json2 = response.data;

    //             } catch (e) {
    //                 alert(e.response.data.rtmsg);
    //                 return;
    //             }

    //             if (json2 != null) {
    //                 console.log(json2);
    //                 // 새로 생성된 data의 PK를 상세 페이지로 전달하여 저장 결과 확인
    //             }
    //         });
    //     }
    // })();
    </script>

</body>