<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GrandJeju - REVIEW</title>
    
    <link rel="stylesheet" href="../assets/css/all.css">
    <link rel="stylesheet" href="../assets/css/header_style.css">
    <link rel="stylesheet" href="../assets/css/side_menu.css">
    <link rel="stylesheet" href="assets/css/style_review.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&family=Rubik&display=swap" rel="stylesheet">
</head>
<body style="margin: 0 auto;">
    <div id="wrap">
        <!-- HEADER -->
        <div id="header">
            <div class="hamburger_icon">
                <a><img src="assets/img/Hamburger_icon.png"></a>
            </div>
            <h2 class="title">REVIEW</h2>
        </div>
        
        <div id="container">
            <!-- 글 작성 버튼 -->
            <div id="btn-group">
                <button class="btn-write-logout">
                    <a>글 작성</a>
                </button>
            </div>

            <div id="content">
                <ul id="content_ul">
                </ul>
            </div>
            
            <!-- 페이지 번호 구현 -->
            <div class="text-center">
                <ul class="pagination">
                    <li class="page-item"><a class="page-link">&laquo</a></li>
                    <li class="page-item active"><a class="page-link">1</a></li>
                    <li class="page-item"><a class="page-link">2</a></li>
                    <li class="page-item"><a class="page-link">3</a></li>
                    <li class="page-item"><a class="page-link">4</a></li>
                    <li class="page-item"><a class="page-link">5</a></li>
                    <li class="page-item"><a class="page-link">&raquo</a></li>
                    
                </ul>
            </div>
        </div>
        
        <!-- 사이드 메뉴바 -->
    <div data-include="../assets/inc/side_menu.html"></div>
</div>


<script src="../assets/js/side_menu_login.js"></script>


    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
    <script async="false" src="../assets/js/include_side.js"></script>
    

    <script src='./assets/js/login_alert.js'></script>
    <script src='https://unpkg.com/sweetalert/dist/sweetalert.min.js'></script>

    <script>
        /** GET 파라미터 받기 */
const params = new URLSearchParams(window.location.search);
const query = params.get('query') || "";
const page = params.get('page') || 1;
const search = params.get('search') || 'title';
const order = params.get('order') || "";


(async () => {
    // ajax 결과가 저장될 json
    let json = null;
    // 총 회원수
    let total_count = null;

    // ajax 요청
    try {
        const response = await axios.get('/review', {
            params: {
                query: query,
                page: page,
                search: search,
                order: order
            }
        });
        const total = await axios.get('/review')
        json = response.data
        total_count = total.data.pagenation.totalCount
        console.log(json);
    } catch (e) {
        // 에러가 발생한 경우 백엔드가 주는 json 받기
        const data = e.response.data;
        alert("[" + data.rt + "] " + data.rtmsg);
    }

    // ajax결과가 존재한다면?
    if (json != null) {
        console.log(json.pagenation);
        json.item.forEach((v) => {
            const content_ul = document.querySelector('#content_ul')
            content_ul.innerHTML +=
            `
                <li>
                    <a>
                        <img src="assets/img/right-arrow.png">
                        <h4 class="title">${v.title}</h4>
                        <p class="date">
                            <span class="name">${v.user_name} |</span>
                            ${v.review_date}
                        </p>
                    </a>
                </li>
            `
        });


        /** 페이지번호 구형 한수 호출하기 */
        // --> 페이지번호 HTML이 출력될 위치에 대한 selector와 페이지 번호 구현에 필요한 정보 전달
        // pagenation(".pagination", json.pagenation);
        // order_btn(decodeURIComponent(location.href));
    }
})();
    </script>
</body>
</html>