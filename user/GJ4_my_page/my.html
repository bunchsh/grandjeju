<!--
 @filename    : my.html
 @author      : 양수원 (ysw7939@gmail.com)
 @description : Grandjeju 마이 페이지의 구조 구현
-->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GrandJeju - MY PAGE</title>

    <link rel="stylesheet" href="../assets/css/side_menu.css" />
    <link rel="stylesheet" href="../assets/css/all.css">
    <link rel="stylesheet" href="../assets/css/header_style.css">
    <link rel="stylesheet" href="assets/css/my_style.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&family=Rubik&display=swap" rel="stylesheet">

</head>

<body>
    <div id="wrap">
        <!-- HEADER -->
        <div id="header">
            <warp class="header_warp">
                <div class="hamburger_icon">
                    <a><img src="assets/img/Hamburger_icon.png"></a>
                </div>
                <h2 class="title">MY PAGE</h2>
            </warp>
        </div>
        <div id="content">
            <div class="user_wrap">
                <a class="setting" href="../GJ5_my_modify/my_modify.html"><img src="assets/img/setting_button.png"></a>
                <a class="user_img"><img src="assets/img/user.png"></a>
                <h3><span class="user_name"></span> 님</h3>
            </div>
            <div id="tabs">
                <div class="tab_three" data-tab='reserve'>
                    <a class="default"><span>예약내역</span></a>
                </div>
                <div class="tab_three" data-tab='inquiry'>
                    <a><span>1:1문의</span></a>
                </div>
                <div class="tab_three" data-tab='review'>
                    <a><span>리뷰내역</span></a>
                </div>
            </div>
        </div>
        <div id="reserve" class="tab_content">
            <div class="history">
                <a href="../GJ7_reservation_detail_page/reservation_detail.html">
                    <img src="assets/img/right-arrow.png">
                    <h3 class="room"></h3>
                    <span class="reserv_name"></span>
                    <div class="stay_date"><span class="stay_start"></span> ~ <span class="stay_end"></span></div>
                    <span class="state"></span>
                </a>
            </div>
        </div>
        <div id="inquiry" class="tab_content none">
            <div class="history">
                <a href="../GJ9_inquiry_detail_page/inquiry_detail_after.html">
                    <img src="assets/img/right-arrow.png">
                    <h3 class="title_inquiry"></h3>
                    <span class="state_inquiry"></span>
                    <span class="inquiry_date"></span>
                </a>
            </div>
            <div class="history">
                <a class="pluse" href="../GJ8_inquiry_write_page/inquiry_write.html">
                    <img src="assets/img/plus.png">
                </a>
            </div>
        </div>
        <div id="review" class="tab_content none">
            <div class="history">
                <a href="../GJ19_review_datail_page/review_detail_writer.html">
                    <img src="assets/img/right-arrow.png">
                    <h3 class="title_review"></h3>
                    <span class="review_date"></span>
                </a>
            </div>
        </div>
        <!-- 사이드 메뉴바 -->
        <div data-include="../assets/inc/side_menu.html"></div>
    </div>

    
    <script src="../assets/js/side_menu_login.js"></script>


    <script type="text/javascript" src="assets/js/tab.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script async="false" src="../assets/js/include_side.js"></script>

    <!-- Fake API 이름 출력 -->
    <script>
        function get_user(user) {
            const xhr = new XMLHttpRequest();
            const method = 'GET';
            const url = "http://172.30.1.4:3000/members/" + user;

            xhr.onreadystatechange = (e) => {
                const { target } = e;

                if (target.readyState == XMLHttpRequest.DONE) {
                    if (target.status == 200) {
                        const req = JSON.parse(target.response);
                        document.querySelector('.user_name').innerHTML = req.user_name;
                    } else {
                        const s = parseInt(target.status / 100);
                        let errMsg = null;

                        if (s == 4) {
                            errMsg = '[' + target.status + ']' + target.statusText + '- 요청 주소가 잘못되었습니다.';
                        } else if (s == 5) {
                            errMsg = '[' + target.status + ']' + target.statusText + '- 서버의 응답이 없습니다.';
                        } else {
                            errMsg = '[' + target.status + ']' + target.statusText + '- 요청에 실패하였습니다.';
                        }
                        alert(errMsg);
                    }
                }
            };

            xhr.open(method, url);
            xhr.send();
        }

        (() => {
            get_user(101);
        })();

    </script>

    <!-- Fake API 예약 내역 출력 -->
    <script>
        function get_reservation(reserv_id) {
            const xhr = new XMLHttpRequest();
            const method = 'GET';
            const url = "http://172.30.1.4:3000/reservation/" + reserv_id;

            xhr.onreadystatechange = (e) => {
                const { target } = e;

                if (target.readyState == XMLHttpRequest.DONE) {
                    if (target.status == 200) {
                        const req = JSON.parse(target.response);
                        document.querySelector('.room').innerHTML = req.room;
                        document.querySelector('.reserv_name').innerHTML = req.reserv_name;
                        document.querySelector('.stay_start').innerHTML = req.stay_start;
                        document.querySelector('.stay_end').innerHTML = req.stay_end;
                        document.querySelector('.state').innerHTML = req.state;
                    } else {
                        const s = parseInt(target.status / 100);
                        let errMsg = null;

                        if (s == 4) {
                            errMsg = '[' + target.status + ']' + target.statusText + '- 요청 주소가 잘못되었습니다.';
                        } else if (s == 5) {
                            errMsg = '[' + target.status + ']' + target.statusText + '- 서버의 응답이 없습니다.';
                        } else {
                            errMsg = '[' + target.status + ']' + target.statusText + '- 요청에 실패하였습니다.';
                        }
                        alert(errMsg);
                    }
                }
            };

            xhr.open(method, url);
            xhr.send();
        }

        (() => {
            get_reservation(9001);
        })();

    </script>

    <!-- Fake API 1:1 문의 내역 출력 -->
    <script>
        function get_inquiry(inquiry_id) {
            const xhr = new XMLHttpRequest();
            const method = 'GET';
            const url = "http://172.30.1.4:3000/inquiry/" + inquiry_id;

            xhr.onreadystatechange = (e) => {
                const { target } = e;

                if (target.readyState == XMLHttpRequest.DONE) {
                    if (target.status == 200) {
                        const req = JSON.parse(target.response);
                        document.querySelector('.title_inquiry').innerHTML = req.title;
                        document.querySelector('.inquiry_date').innerHTML = req.inquiry_date;
                        document.querySelector('.state_inquiry').innerHTML = req.state;
                    } else {
                        const s = parseInt(target.status / 100);
                        let errMsg = null;

                        if (s == 4) {
                            errMsg = '[' + target.status + ']' + target.statusText + '- 요청 주소가 잘못되었습니다.';
                        } else if (s == 5) {
                            errMsg = '[' + target.status + ']' + target.statusText + '- 서버의 응답이 없습니다.';
                        } else {
                            errMsg = '[' + target.status + ']' + target.statusText + '- 요청에 실패하였습니다.';
                        }
                        alert(errMsg);
                    }
                }
            };

            xhr.open(method, url);
            xhr.send();
        }

        (() => {
            get_inquiry(900001);
        })();

    </script>

    <!-- Fake API 리뷰 내역 출력 -->
    <script>
        function get_review(review_id) {
            const xhr = new XMLHttpRequest();
            const method = 'GET';
            const url = "http://172.30.1.4:3000/review/" + review_id;

            xhr.onreadystatechange = (e) => {
                const { target } = e;

                if (target.readyState == XMLHttpRequest.DONE) {
                    if (target.status == 200) {
                        const req = JSON.parse(target.response);
                        document.querySelector('.title_review').innerHTML = req.title;
                        document.querySelector('.review_date').innerHTML = req.review_date;
                    } else {
                        const s = parseInt(target.status / 100);
                        let errMsg = null;

                        if (s == 4) {
                            errMsg = '[' + target.status + ']' + target.statusText + '- 요청 주소가 잘못되었습니다.';
                        } else if (s == 5) {
                            errMsg = '[' + target.status + ']' + target.statusText + '- 서버의 응답이 없습니다.';
                        } else {
                            errMsg = '[' + target.status + ']' + target.statusText + '- 요청에 실패하였습니다.';
                        }
                        alert(errMsg);
                    }
                }
            };

            xhr.open(method, url);
            xhr.send();
        }

        (() => {
            get_review(90001);
        })();

    </script>
</body>

</html>