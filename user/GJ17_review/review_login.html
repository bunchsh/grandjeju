<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GrandJeju - REVIEW</title>

    <link rel="stylesheet" href="../assets/css/all.css">
    <link rel="stylesheet" href="../assets/css/header_style.css">
    <link rel="stylesheet" href="../assets/css/side_menu.css">
    <link rel="stylesheet" href="assets/css/style_review.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&family=Rubik&display=swap" rel="stylesheet">
</head>

<body style="margin: 0 auto;">
    <div id="wrap">
        <!-- HEADER -->
        <div id="header">
            <div class="hamburger_icon">
                <a><img src="assets/img/Hamburger_icon.png"></a>
            </div>
            <h2 class="title">REVIEW</h2>
        </div>

        <!-- 글 작성 버튼 -->
        <div id="btn-group">
            <button class="btn-write">
                <a href="../GJ18_review_write_page/review_write.html">글 작성</a>
            </button>
        </div>

        <div id="content">
            <ul id="list">
            </ul>
        </div>

        <!-- 페이지 번호 구현 -->
        <div class="text-center">
            <ul class="pagination">
                <li class="page-item"><a class="page-link">&laquo</a></li>
                <li class="page-item active"><a class="page-link">1</a></li>
                <li class="page-item"><a class="page-link">2</a></li>
                <li class="page-item"><a class="page-link">3</a></li>
                <li class="page-item"><a class="page-link">4</a></li>
                <li class="page-item"><a class="page-link">5</a></li>
                <li class="page-item"><a class="page-link">&raquo</a></li>

            </ul>
        </div>

        <!-- 사이드 메뉴바 -->
        <div data-include="../assets/inc/side_menu_login.html"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
    <script async="false" src="../assets/js/include.js"></script>

    <script>
        (() => {
            const xhr = new XMLHttpRequest();
            const method = 'GET';
            const url = "http://localhost:3000/review";

            xhr.onreadystatechange = (e) => {
                const { target } = e;

                if (target.readyState == XMLHttpRequest.DONE) {
                    if (target.status == 200) {
                        const req = JSON.parse(target.response);
                        const listBody = document.querySelector("#list");

                        req.map((v, i) => {
                            const li = document.createElement("li");

                            const a = document.createElement("a");
                            a.setAttribute("href", "../GJ19_review_datail_page/review_detail_general.html")

                            const img = document.createElement("img");
                            img.setAttribute("src", 'assets/img/right-arrow.png');

                            const h4 = document.createElement("h4");
                            h4.innerHTML = v.title;

                            const p = document.createElement("p");

                            const span1 = document.createElement("span");
                            span1.innerHTML = v.user_name + " | ";

                            const span2 = document.createElement("span");
                            span2.innerHTML = v.review_date;

                            li.appendChild(a);

                            a.appendChild(img);
                            a.appendChild(h4);
                            a.appendChild(p);

                            p.appendChild(span1);
                            p.appendChild(span2);

                            listBody.appendChild(li);
                        });
                    } else {
                        const s = parseInt(target.status / 100);
                        let errMsg = null;

                        if (s == 4) {
                            errMsg = '[' + target.status + ']' + target.statusText + '- 요청 주소가 잘못되었습니다.';
                        } else if (s == 5) {
                            errMsg = '[' + target.status + ']' + target.statusText + '- 서버의 응답이 없습니다.';
                        } else {
                            errMsg = '[' + target.status + ']' + target.statusText + '- 요청에 실패하였습니다.';
                        }
                        alert(errMsg);
                    }
                }
            };

            // 요청을 초기화
            xhr.open(method, url);

            // xhr객체가 요청을 백엔드에 전송
            xhr.send();
        })();
    </script>
</body>

</html>